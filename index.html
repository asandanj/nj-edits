<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NJ Edits - Premium AI Photo Editor</title>
<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0b0b0b;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
.container{
  background:#141414;
  padding:30px;
  border-radius:12px;
  width:100%;
  max-width:480px;
  text-align:center;
  box-shadow:0 0 30px rgba(255,215,0,0.2);
}
h1{margin-bottom:5px; font-size:2.5rem; color:gold;}
p{margin-bottom:20px; color:#ccc;}
input{display:none;}
label{
  display:block;
  padding:12px;
  background:gold;
  color:black;
  border-radius:8px;
  cursor:pointer;
  margin:15px 0;
  font-weight:bold;
}
img{
  max-width:100%;
  border-radius:10px;
  margin-top:15px;
}
button{
  margin-top:15px;
  padding:12px;
  width:100%;
  border:none;
  background:gold;
  color:black;
  border-radius:8px;
  font-size:16px;
  cursor:pointer;
  font-weight:bold;
}
select{
  width:100%;
  padding:10px;
  margin-top:15px;
  border-radius:8px;
  border:none;
  font-weight:bold;
}
footer{
  margin-top:15px;
  font-size:12px;
  color:#777;
}
#premium-info{
  margin-top:10px;
  color:#ffd700;
  font-weight:bold;
}
#buy-btn{
  background:#ffd700;
  color:black;
  font-weight:bold;
}
</style>
</head>

<body>
<div class="container">
  <h1>NJ Edits</h1>
  <p>Upload a photo and apply cinematic & AI-powered edits</p>

  <label for="upload">Upload Photo</label>
  <input type="file" id="upload" accept="image/*">

  <select id="filter">
    <option value="none">Original</option>
    <option value="contrast(1.2) saturate(1.2)">Cinematic</option>
    <option value="contrast(1.4) saturate(1.5) brightness(1.1)">Vivid</option>
    <option value="grayscale(1)">Black & White</option>
    <option value="sepia(0.8)">Warm Glow</option>
    <option value="hue-rotate(200deg) saturate(1.3)">Cool Tone</option>
    <option value="contrast(1.3) saturate(1.2) brightness(0.9)">Moody</option>
    <option value="contrast(1.1) saturate(1.6) brightness(1.2)">Pop Colors</option>
    <option value="blur(1px) contrast(1.2) saturate(1.3)">Soft Focus</option>
    <option value="brightness(1.1) saturate(1.5) hue-rotate(10deg)">Golden Hour</option>
    <option value="ai-premium-1">AI Premium: Ultra Cinematic</option>
    <option value="ai-premium-2">AI Premium: High Fashion</option>
    <option value="ai-premium-3">AI Premium: Dreamy Vivid</option>
  </select>

  <div id="premium-info"></div>
  <button id="buy-btn" onclick="buyPremium()">Subscribe: 3 Premium Edits / 2 Weeks (R35.46)</button>

  <img id="preview" style="display:none;">

  <button onclick="downloadImage()">Download Edit</button>

  <footer>Â© NJ Edits</footer>
</div>

<script>
const upload = document.getElementById("upload");
const preview = document.getElementById("preview");
const filter = document.getElementById("filter");
const premiumInfo = document.getElementById("premium-info");

const usageKey = "nj-edits-premium-usage";
const timeKey = "nj-edits-premium-start";

// Load usage & timestamp
let usage = JSON.parse(localStorage.getItem(usageKey)) || 0;
let startTime = localStorage.getItem(timeKey) || null;

// Check if 2 weeks have passed
function checkSubscription() {
  if (!startTime) return false;
  const now = new Date().getTime();
  const diff = now - parseInt(startTime);
  const twoWeeks = 14 * 24 * 60 * 60 * 1000; // 2 weeks in ms
  if(diff >= twoWeeks){
    usage = 0;
    startTime = null;
    localStorage.removeItem(timeKey);
    localStorage.setItem(usageKey, JSON.stringify(usage));
  }
}
checkSubscription();
updatePremiumInfo();

// Upload image preview
upload.addEventListener("change", e => {
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = () => {
    preview.src = reader.result;
    preview.style.display = "block";
    preview.style.filter = "none"; // reset filter
  };
  reader.readAsDataURL(file);
});

// Apply filter
filter.addEventListener("change", () => {
  const val = filter.value;

  if(val.startsWith("ai-premium")) {
    checkSubscription();
    if(usage >= 3){
      alert("You have reached your 3 premium AI edits limit for this 2-week period. Subscribe to reset.");
      filter.value = "none";
      preview.style.filter = "none";
      return;
    } else {
      usage++;
      localStorage.setItem(usageKey, JSON.stringify(usage));
      alert(`Premium AI edit applied! You have ${3-usage} premium edits left for this period.`);
      // Simulate AI effect
      preview.style.filter = "contrast(1.5) saturate(1.6) brightness(1.05) sepia(0.1)";
      updatePremiumInfo();
    }
  } else {
    preview.style.filter = val;
  }
});

// Download image
function downloadImage(){
  if(!preview.src) return alert("Upload an image first");

  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");
  const img = new Image();
  img.src = preview.src;

  img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.filter = filter.value.startsWith("ai-premium")
      ? "contrast(1.5) saturate(1.6) brightness(1.05) sepia(0.1)"
      : filter.value;
    ctx.drawImage(img, 0, 0);
    const link = document.createElement("a");
    link.download = "nj-edits.png";
    link.href = canvas.toDataURL();
    link.click();
  };
}

// Update premium info on page
function updatePremiumInfo(){
  const left = 3 - usage;
  premiumInfo.textContent = `Premium AI edits remaining this 2-week period: ${left}`;
}

// Simulate subscription purchase
function buyPremium(){
  const confirmBuy = confirm("Subscribe for 3 Premium AI edits every 2 weeks for R35.46?");
  if(confirmBuy){
    usage = 0; 
    startTime = new Date().getTime();
    localStorage.setItem(usageKey, JSON.stringify(usage));
    localStorage.setItem(timeKey, startTime.toString());
    alert("Subscription activated! You now have 3 premium AI edits for the next 2 weeks.");
    updatePremiumInfo();
  }
}
</script>
</body>
</html>
